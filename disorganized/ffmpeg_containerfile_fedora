FROM fedora
MAINTAINER armelvil
RUN dnf update
RUN dnf install autoconf automake bzip2 bzip2-devel cmake freetype-devel gcc gcc-c++ git libtool make pkgconfig zlib-devel
RUN git clone https://git.ffmpeg.org/ffmpeg.git ffmpeg
RUN cd ~/ffmpeg
RUN curl -O -L https://www.nasm.us/pub/nasm/releasebuilds/2.15.05/nasm-2.15.05.tar.bz2
RUN tar xjvf nasm-2.15.05.tar.bz2
RUN cd nasm-2.15.05
RUN ./autogen.sh
RUN ./configure --prefix="$HOME/ffmpeg_build" --bindir="$HOME/bin"
RUN make
RUN make install
RUN pwd
RUN cd ~/ffmpegs
RUN curl -O -L https://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz
RUN tar xzvf yasm-1.3.0.tar.gz
RUN cd yasm-1.3.0
RUN ./configure --prefix="$HOME/ffmpeg_build" --bindir="$HOME/bin"
RUN pwd
RUN cd..
RUN make
RUN make install
RUN cd ~/ffmpeg
RUN curl -O -L https://archive.mozilla.org/pub/opus/opus-1.3.1.tar.gz
RUN tar xzvf opus-1.3.1.tar.gz
RUN cd opus-1.3.1
RUN ./configure --prefix="$HOME/ffmpeg_build" --disable-shared
RUN make
RUN pwd
RUN git clone --branch stable --depth 2 https://bitbucket.org/multicoreware/x265_git
RUN cd ~/ffmpeg/x265_git/build/linux
RUN cmake -G "Unix Makefiles" -DCMAKE_INSTALL_PREFIX="$HOME/ffmpeg_build" -DENABLE_SHARED:bool=off ../../source
RUN make
RUN make install
RUN pwd
RUN cd ~/ffmpeg
RUN git clone --branch stable --depth 1 https://code.videolan.org/videolan/x264.git
RUN cd x264
RUN PKG_CONFIG_PATH="$HOME/ffmpeg_build/lib/pkgconfig" ./configure --prefix="$HOME/ffmpeg_build" --bindir="$HOME/bin" --enable-static
RUN make
RUN make install
RUN pwd
RUN cd ~/ffmpegs
RUN git clone --depth 1 https://chromium.googlesource.com/webm/libvpx.git
RUN cd libvpx
RUN ./configure --prefix="$HOME/ffmpeg_build" --disable-examples --disable-unit-tests --enable-vp9-highbitdepth --as=yasm
RUN make
RUN make install
CMD 
